Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=1)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=10)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=9)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=8)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=6)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=4)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=2)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet = rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
#rfor<-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor)
#print(rfor)
#print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
#tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
#confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
explain_forest(rfor)
print(rfor)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
tree.predict2<-predict(rfor, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(tree.predict2,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
explain_forest(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
install.packages("visreg")
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor.planet)
visreg(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
library(visreg)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE)
#explain_forest(rfor.planet)
visreg(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
Planets_dataset_test_SET <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalog_test.xlsx"))
set.seed(1)
#caret.control <- trainControl(method = "cv",number=4)
#rpart.cv <- train(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY, data = Planets_dataset,method = "rpart",trControl = caret.control)
rpart.cv <- train(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY, data = Planets_dataset,method = "rpart")
#rpart.best <- rpart.cv$finalModel
prp(rpart.best, type = 5, extra = 1, under = TRUE)
tree.predict<-predict(rpart.cv,Planets_dataset_test_SET)
peppo<-data.frame(tree.predict)
confusionMatrix(table(tree.predict,Planets_dataset_test_SET[,12]))
visreg(rfor.planet,plot=TRUE)
visreg(rfor.planet,"S_LUMINOSITY",plot=TRUE)
visreg(Planets_dataset,"S_LUMINOSITY",plot=TRUE)
plot(rfor.planet,log="y")
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
MDSplot(rfor.planet,P_HABITABLE)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE,proximity=TRUE)
#explain_forest(rfor.planet)
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3))
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=as.numeric(iPlanets_dataset$P_HABITABLE))
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=as.numeric(Planets_dataset$P_HABITABLE))
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=colorRampPalette(c("green", "blue", "red")),pch=as.numeric(Planets_dataset$P_HABITABLE))
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=3)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=3)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=8)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=1)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=pch=as.numeric(Planets_dataset$P_HABITABLE))
varImpPlot(rfor.planet)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=rep(1, 3),pch=as.numeric(Planets_dataset$P_HABITABLE))
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE,palette=brewer.pal(8, "Dark2"),pch=as.numeric(Planets_dataset$P_HABITABLE))
varImpPlot(rfor.planet)
MDSplot(rfor.planet,Planets_dataset$P_HABITABLE)
install.packages("rfPermute")
library(rfPermute)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE,proximity=TRUE)
#explain_forest(rfor.planet)
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE,proximity=TRUE)
#explain_forest(rfor.planet)
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
library(readxl)
library(ISLR)
library(readxl)
library(devtools)
library(ggfortify)
library(ggrepel)
library(ggplot2)
library(corrplot)
library(factoextra)
library(dendextend)
library(mdendro)
library(rpart)
library(rpart.plot)
library(caret)
library(tree)
library(randomForest)
library(randomForestExplainer)
library(rpart.plot)
library(visreg)
library(rfPermute)
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE,proximity=TRUE)
#explain_forest(rfor.planet)
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
print(rfor.planet)
print(importance(rfor,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
caret::confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
caret::confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
Planets_dataset <- data.frame(read_excel("C:/Users/Marzio/Desktop/Planets/phl_exoplanet_catalogR.xlsx"))
set.seed(2)
Planets_dataset_train<- sample(499,400)
Planets_dataset_test<-Planets_dataset[-Planets_dataset_train,]
tree.planet <- rpart(P_HABITABLE~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset,method="class", subset=Planets_dataset_train,minsplit = 5)
rfor.planet <-randomForest(as.factor(P_HABITABLE)~P_DISTANCE+P_PERIASTRON+P_APASTRON+P_DISTANCE_EFF+P_FLUX+P_TEMP_EQUIL+S_RADIUS_EST+S_LUMINOSITY,data=Planets_dataset, subset=Planets_dataset_train,localImp = TRUE,importance=TRUE,proximity=TRUE)
#explain_forest(rfor.planet)
plot(rfor.planet,log="y")
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
print(rfor.planet)
print(importance(rfor.planet,type=2))
#printcp(tree.planet)
rpart.plot(tree.planet,box.palette=c("red", "green"),digits=4,extra=106)
tree.predict<-predict(tree.planet, Planets_dataset_test, type = "class")
rfor.predict<-predict(rfor.planet, Planets_dataset_test, type = "class")
caret::confusionMatrix(table(tree.predict,Planets_dataset_test[,12]))
caret::confusionMatrix(table(rfor.predict,Planets_dataset_test[,12]))
plot(rfor.planet,log="l")
plot(rfor.planet)
plot(rfor.planet)
View(rfor.planet)
plot(rfor.planet,type="l")
partialPlot(rfor.planet,Planets_dataset,P_HABITABLE)
partialPlot(rfor.planet,Planets_dataset)
partialPlot(rfor.planet,Planets_dataset,P_HABITABLE,"ppepo")
partialPlot(rfor.planet,Planets_dataset,P_TEMP_EQUIL,P_HABITABLE)
partialPlot(rfor.planet,Planets_dataset,Planets_dataset$P_TEMP_EQUIL,Planets_dataset$P_HABITABLE)
plot(rfor.planet)
varImpPlot(rfor.planet)
proximityPlot(rfor.planet)
plot(rfor.planet)
legend("top", colnames(rfor.planet$err.rate), fill=1:ncol(rfor.planetf$err.rate))
plot(rfor.planet)
legend("top", colnames(rfor.planet$err.rate), fill=1:ncol(rfor.planet$err.rate))
